# -*- coding: utf-8 -*-
"""mlbox (regression on house price prediction advance).ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1QCX9-5aKVVEG_UWCy11WMy7Eela0_ZYW
"""

!pip install mlbox

from mlbox.preprocessing import *
 from mlbox.optimisation import *
 from mlbox.prediction import *

target_name = 'SalePrice'
rd = Reader(sep=",")
df = rd.train_test_split(['/content/test.csv','/content/train.csv'],target_name)

dft = Drift_thresholder()
df = dft.fit_transform(df)

space = {
    'est__strategy':{"Search":"choice","space":['LightGBM']},
    'est__n_estimators':{"Search":"choice","space":[150]},
    'est__colsample_bytree':{"search":'uniform','space':[0.8,0.95]},
    'est__subsample':{'search':'uniform','space':[0.8,0.95]},
    'est__max_depth':{'search':'choice','space':[5,6,7,8,9]},
    'est__learning_rate':{'search':'choice','space':[0.07]}
}
params = Optimiser().optimise(space, df,15)

pred = Predictor()
pred.fit_predict(params,df)